<div class="chat-panel">
  <div class="chat-header">
    <div class="chat-header-info">
      <span class="chat-header-title">xAI Bot</span>
      <span class="chat-header-status"
        [class.chat-header-status--connected]="chat.connectionState() === 'connected'">
        {{ chat.connectionState() === 'connected'
           ? i18n.t('chat.connected')
           : i18n.t('chat.connecting') }}
      </span>
    </div>
    <button class="chat-close" (click)="chat.toggle()" aria-label="Close chat">&times;</button>
  </div>

  <div class="chat-messages" #messageList>
    @for (msg of chat.messages(); track msg.id) {
      <div class="chat-bubble"
        [class.chat-bubble--user]="msg.sender === 'user'"
        [class.chat-bubble--bot]="msg.sender === 'bot'"
        [class.chat-bubble--system]="msg.sender === 'system'">
        {{ msg.text }}
      </div>
    }
    @if (chat.messages().length === 0) {
      <div class="chat-empty">{{ i18n.t('chat.empty') }}</div>
    }
  </div>

  <div class="chat-input-bar">
    <textarea
      class="chat-input"
      [(ngModel)]="messageText"
      [placeholder]="i18n.t('chat.placeholder')"
      (keydown)="onKeydown($event)"
      rows="1"></textarea>
    <button class="chat-send"
      [disabled]="!messageText.trim()"
      (click)="send()">
      {{ i18n.t('chat.send') }}
    </button>
  </div>
</div>
